{% extends 'base.html.twig' %}

{% block title %}
    Réservez votre véhicule
{% endblock %}

{% block body %}
    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="bg-white p-6 rounded-lg shadow-lg lg:col-span-1">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Résumé de la réservation</h3>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-300 space-y-4">
                    <h4 class="text-xl font-semibold text-gray-800">Détails</h4>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600" data-vehicle-id="{{ vehicle.id }}">Véhicule</span>
                        <span class="font-semibold text-gray-800">{{ vehicle.brand }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Prix par jour</span>
                        <span class="font-semibold text-gray-800" id="pricePerDay" data-price="{{ vehicle.price }}">{{ vehicle.price }}€</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Durée</span>
                        <span class="font-semibold text-gray-800" id="daysCount">0 jours</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Options</span>
                        <span class="font-semibold text-gray-800" id="options-price">0.00 €</span>
                    </div>
                    <div class="border-t border-gray-300 mt-2 pt-2 flex justify-between items-center">
                        <span class="font-semibold text-gray-800">Total</span>
                        <span class="font-bold text-blue-600 text-xl" id="totalPrice">0.00 €</span>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-lg lg:col-span-2">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Informations du véhicule</h3>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-300 space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Marque</span>
                            <span class="font-semibold text-gray-800">{{ vehicle.brand }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Modèle</span>
                            <span class="font-semibold text-gray-800">{{ vehicle.model }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Année</span>
                            <span class="font-semibold text-gray-800">{{ vehicle.year }}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Kilométrage</span>
                            <span class="font-semibold text-gray-800">{{ vehicle.mileage }}
								km</span>
                        </div>
                    </div>
                </div>

                {{ form_start(form, { 'attr': {'id': 'reservation-form', 'class': 'mt-6'} }) }}
                <h4 class="text-xl font-semibold text-gray-800 mb-4">Sélectionnez vos options</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for option in vehicle.vehicleOptions %}
                        <div class="bg-gray-50 p-4 rounded-lg shadow-md border border-gray-200">
                            <div class="flex items-center justify-between">
                                <span class="text-lg font-medium text-gray-800">{{ option.name }}</span>
                                <div class="flex items-center space-x-2">
                                    {% if option.singleChoice %}
                                        <input type="checkbox" id="option_{{ option.id }}_count" name="options[{{ option.id }}]" value="1" data-option-id="{{ option.id }}" data-price="{{ option.price }}" class="checkbox text-blue-500">
                                    {% else %}
                                        <button type="button" class="option-minus bg-gray-300 text-gray-700 rounded-full w-8 h-8 flex items-center justify-center" data-option-id="{{ option.id }}" data-price="{{ option.price }}">
                                            -
                                        </button>
                                        <span id="option_{{ option.id }}_count" class="font-semibold text-gray-800">{{ option.count ?? 0 }}</span>
                                        <button type="button" class="option-plus bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center" data-option-id="{{ option.id }}" data-price="{{ option.price }}">
                                            +
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mt-2">{{ option.description }}</p>
                            <input type="hidden" name="options[{{ option.id }}]" id="option_{{ option.id }}_count_hidden" value="{{ option.count ?? 0 }}">
                        </div>
                    {% endfor %}
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="reservation_startDate" class="block text-lg font-medium text-gray-700 mb-2">Date de départ</label>
                        {{ form_widget(form.startDate) }}
                    </div>
                    <div>
                        <label for="reservation_endDate" class="block text-lg font-medium text-gray-700 mb-2">Date de retour</label>
                        {{ form_widget(form.endDate) }}
                    </div>
                </div>

                <div class="mt-6 flex justify-end space-x-4">
                    <button type="button" class="bg-gray-500 text-white py-2 px-6 rounded-lg hover:bg-gray-600 transition">
                        Annuler
                    </button>
                    <button type="submit" class="bg-blue-500 text-white py-2 px-6 rounded-lg hover:bg-blue-600 transition">
                        Réserver
                    </button>
                </div>
                {{ form_end(form) }}
            </div>
        </div>

    </div>
    s

    {% block javascripts %}

        <script src="{{ asset('js/disabled_range_date.js') }}"></script>
        <script src="{{ asset('js/total_price.js') }}"></script>
    {% endblock %}
{% endblock %}